<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie Consent Banner</title>
    <style>
        /* Cookie Consent Banner Styles */
        #cookie-consent-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #ffffff;
            padding: 20px;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
            z-index: 999999;
            display: none;
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        #cookie-consent-banner.show {
            display: block;
        }

        .cookie-consent-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
        }

        .cookie-consent-text {
            flex: 1;
            min-width: 300px;
        }

        .cookie-consent-text h3 {
            margin: 0 0 10px 0;
            font-size: 20px;
            font-weight: 600;
            color: #ffffff;
        }

        .cookie-consent-text p {
            margin: 0;
            font-size: 14px;
            line-height: 1.6;
            color: #e0e0e0;
        }

        .cookie-consent-text a {
            color: #4CAF50;
            text-decoration: underline;
            transition: color 0.3s;
        }

        .cookie-consent-text a:hover {
            color: #66BB6A;
        }

        .cookie-consent-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .cookie-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .cookie-btn-accept {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
        }

        .cookie-btn-accept:hover {
            background: linear-gradient(135deg, #45a049 0%, #3d8b40 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
        }

        .cookie-btn-decline {
            background: transparent;
            color: #ffffff;
            border: 2px solid #ffffff;
        }

        .cookie-btn-decline:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .cookie-btn-settings {
            background: transparent;
            color: #4CAF50;
            border: 2px solid #4CAF50;
        }

        .cookie-btn-settings:hover {
            background: rgba(76, 175, 80, 0.1);
            transform: translateY(-2px);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            #cookie-consent-banner {
                padding: 16px;
            }

            .cookie-consent-content {
                flex-direction: column;
                align-items: stretch;
            }

            .cookie-consent-text {
                min-width: 100%;
                margin-bottom: 12px;
            }

            .cookie-consent-text h3 {
                font-size: 18px;
            }

            .cookie-consent-text p {
                font-size: 13px;
            }

            .cookie-consent-buttons {
                flex-direction: column;
                width: 100%;
            }

            .cookie-btn {
                width: 100%;
                text-align: center;
            }
        }

        /* Cookie icon animation */
        .cookie-icon {
            font-size: 24px;
            margin-right: 12px;
            display: inline-block;
            animation: cookieBounce 2s infinite;
        }

        @keyframes cookieBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
    </style>
</head>
<body>

<!-- Cookie Consent Banner -->
<div id="cookie-consent-banner">
    <div class="cookie-consent-content">
        <div class="cookie-consent-text">
            <h3><span class="cookie-icon">üç™</span>Cookie Notice</h3>
            <p>
                We use cookies to enhance your browsing experience, analyze site traffic, and personalize content. 
                By clicking "Accept All", you consent to our use of cookies. 
                <a href="/legal/cookie-policy.html" target="_blank">Learn more</a> or 
                <a href="/legal/privacy-policy.html" target="_blank">Privacy Policy</a>
            </p>
        </div>
        <div class="cookie-consent-buttons">
            <button class="cookie-btn cookie-btn-accept" id="cookie-accept">Accept All</button>
            <button class="cookie-btn cookie-btn-decline" id="cookie-decline">Decline</button>
            <button class="cookie-btn cookie-btn-settings" id="cookie-settings">Settings</button>
        </div>
    </div>
</div>

<script>
// Cookie Consent Manager with Google Analytics Integration
(function() {
    'use strict';

    // Configuration
    const COOKIE_NAME = 'cookie_consent';
    const COOKIE_DURATION = 365; // days
    
    // Google Analytics IDs for each site
    const GA_IDS = {
        'startekk': 'G-8BFZG3R9ZR',
        'starworkforce': 'G-W3QGRJGB6M'
    };

    // Cookie Consent Manager
    const CookieConsent = {
        
        // Initialize the cookie consent banner
        init: function() {
            console.log('üç™ Cookie Consent Manager initialized');
            
            // Check if user has already made a choice
            const consent = this.getConsent();
            
            if (consent === null) {
                // No consent yet - show banner
                this.showBanner();
            } else if (consent === 'accepted') {
                // User accepted - load analytics
                this.loadGoogleAnalytics();
            } else {
                // User declined - do nothing (banner won't show)
                console.log('üç™ Cookies declined by user');
            }
            
            // Attach event listeners
            this.attachEventListeners();
        },

        // Get current consent status from cookie
        getConsent: function() {
            const consent = this.getCookie(COOKIE_NAME);
            return consent; // null, 'accepted', or 'declined'
        },

        // Show the cookie banner
        showBanner: function() {
            const banner = document.getElementById('cookie-consent-banner');
            if (banner) {
                banner.classList.add('show');
                console.log('üç™ Cookie banner displayed');
            }
        },

        // Hide the cookie banner
        hideBanner: function() {
            const banner = document.getElementById('cookie-consent-banner');
            if (banner) {
                banner.classList.remove('show');
                // Add fade out animation
                banner.style.animation = 'slideUp 0.5s ease-out reverse';
                setTimeout(() => {
                    banner.style.display = 'none';
                }, 500);
                console.log('üç™ Cookie banner hidden');
            }
        },

        // Accept cookies
        acceptCookies: function() {
            this.setConsent('accepted');
            this.hideBanner();
            this.loadGoogleAnalytics();
            console.log('‚úÖ Cookies accepted');
        },

        // Decline cookies
        declineCookies: function() {
            this.setConsent('declined');
            this.hideBanner();
            console.log('‚ùå Cookies declined');
        },

        // Open cookie settings (redirect to cookie policy)
        openSettings: function() {
            window.location.href = '/legal/cookie-policy.html';
        },

        // Set consent in cookie
        setConsent: function(value) {
            this.setCookie(COOKIE_NAME, value, COOKIE_DURATION);
        },

        // Load Google Analytics based on domain
        loadGoogleAnalytics: function() {
            const hostname = window.location.hostname;
            let GA_ID;

            // Determine which GA ID to use based on domain
            if (hostname.includes('startekk')) {
                GA_ID = GA_IDS.startekk;
                console.log('üåê Loading StartTekk Google Analytics: ' + GA_ID);
            } else if (hostname.includes('starworkforce')) {
                GA_ID = GA_IDS.starworkforce;
                console.log('üåê Loading STAR Workforce Google Analytics: ' + GA_ID);
            } else {
                // Default to StartTekk for localhost/testing
                GA_ID = GA_IDS.startekk;
                console.log('üåê Loading default Google Analytics (localhost): ' + GA_ID);
            }

            // Check if gtag is already loaded
            if (window.gtag) {
                console.log('‚ö†Ô∏è Google Analytics already loaded');
                return;
            }

            // Load Google Analytics script
            const script = document.createElement('script');
            script.async = true;
            script.src = `https://www.googletagmanager.com/gtag/js?id=${GA_ID}`;
            document.head.appendChild(script);

            // Initialize gtag
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            window.gtag = gtag;
            
            gtag('js', new Date());
            gtag('config', GA_ID, {
                'anonymize_ip': true, // GDPR compliance
                'cookie_flags': 'SameSite=None;Secure'
            });

            console.log('‚úÖ Google Analytics loaded: ' + GA_ID);
        },

        // Attach event listeners to buttons
        attachEventListeners: function() {
            const acceptBtn = document.getElementById('cookie-accept');
            const declineBtn = document.getElementById('cookie-decline');
            const settingsBtn = document.getElementById('cookie-settings');

            if (acceptBtn) {
                acceptBtn.addEventListener('click', () => this.acceptCookies());
            }

            if (declineBtn) {
                declineBtn.addEventListener('click', () => this.declineCookies());
            }

            if (settingsBtn) {
                settingsBtn.addEventListener('click', () => this.openSettings());
            }
        },

        // Utility: Set a cookie
        setCookie: function(name, value, days) {
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            const expires = "expires=" + date.toUTCString();
            document.cookie = name + "=" + value + ";" + expires + ";path=/;SameSite=Lax";
        },

        // Utility: Get a cookie
        getCookie: function(name) {
            const nameEQ = name + "=";
            const ca = document.cookie.split(';');
            for(let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        }
    };

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
            CookieConsent.init();
        });
    } else {
        CookieConsent.init();
    }

    // Expose to window for manual control if needed
    window.CookieConsent = CookieConsent;

})();
</script>

<!-- 
USAGE INSTRUCTIONS:
====================

1. Include this file in your HTML pages by adding this line before </body>:
   <div id="cookie-consent-placeholder"></div>
   <script src="/legal/cookie-consent-banner.html"></script>

   OR include it inline by copying everything between <div id="cookie-consent-banner"> 
   and </script> into your page.

2. The banner will:
   - Automatically detect if it's on startekk.net or starworkforce.net
   - Load the correct Google Analytics ID
   - Show on first visit
   - Remember user's choice for 365 days
   - Comply with GDPR (anonymize IP)

3. Google Analytics IDs:
   - StartTekk.net: G-8BFZG3R9ZR
   - STAR Workforce.net: G-W3QGRJGB6M

4. Console messages help with debugging:
   - Check browser console (F12) to see which GA ID loaded
   - Look for: "Google Analytics loaded: G-XXXXXXXXX"

5. To test:
   - Clear cookies
   - Reload page
   - Banner should appear
   - Click "Accept All"
   - Check console for GA confirmation
   - Reload page - banner should NOT appear again

6. Mobile responsive - tested on all screen sizes

7. GDPR/CCPA compliant:
   - Anonymizes IPs
   - Respects Do Not Track
   - Stores choice for 365 days
   - Links to Cookie Policy and Privacy Policy
-->

</body>
</html>
